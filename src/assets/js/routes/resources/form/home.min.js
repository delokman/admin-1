!function(){"use strict";var G=window.tabId,t=function(){var t,h=$("#app-tab-"+G),p=0,b=0,_=0,w=h.find("#cards-graphs-amount").find("#dayAmount"),e=h.find("#home-cards"),n=e.find("#home-name"),o=e.find("#home-object"),a=e.find("#home-id"),r=localStorage.getItem("store_id"),v=h.find("#lastOrders").find("#addOrders"),x=h.find("#approved"),y=h.find("#monthAmount"),d=h.find("#cards-graphs-amount-last"),D=h.find("#lastApproved"),A=h.find("#lastMonthAmount"),k=d.find("#lastDayAmount"),M=h.find("#monthTotalOrders"),T=h.find("#monthTotalOrdersApproved"),z=h.find("#lastMonthTotalOrders"),I=h.find("#lastMonthTotalOrdersApproved"),i=function(t){return t<10?"0"+t:t},s=function(t){return t.getFullYear()+"-"+i(t.getMonth()+1)+"-"+i(t.getDate())+"T"+i(t.getHours())+":"+i(t.getMinutes())+":"+i(t.getSeconds())+".000Z"},u=function(t){return t.getFullYear()+"-"+i(t.getMonth()+1)+"-"+i(t.getDate())+"T"+i(t.getHours())+":"+i(t.getMinutes())+":"+i(t.getSeconds())+".999Z"},l=new Date,c=l.getDate(),f=l.getMonth(),m=l.getFullYear(),g=(t=(new Date).getTimezoneOffset())<0?-1*t:t,O=s(new Date(m,f,c-1,0,g,0,0)),S=u(new Date(m,f,c-1,23,59+g,59,0)),C=s(new Date(m,f-1,1,0,g,0,0)),F=u(new Date(m,f-1,31,23,59+g,59,0)),P=s(new Date(m,f,c,0,g,0,0)),B=u(new Date(m,f,c,23,59+g,59,0)),R=s(new Date(m,f,1,0,g,0,0)),E=u(new Date(m,f,31,23,59+g,59,0)),L=0,U=0,j="orders.json?sort=amount&created_at>="+C+"&fields=buyers,amount,_id,created_at,financial_status,number,status";a.text(r);var Y=function(t,e){return{amount:{total:t.amount.total+e.amount.total}}};window.callApi("stores/me.json","GET",function(t,e){if(!t){var a=e.name;n.text(a);var r=e._id;o.text(r),localStorage.setItem("fromAddress",e.address),localStorage.setItem("fromContact",e.contact_phone),localStorage.setItem("fromName",e.name),localStorage.setItem("fromCorporate",e.corporate_name),localStorage.setItem("domain",e.domain)}}),$(document).ready(function(){setTimeout(function(){window.callApi(j,"GET",function(t,e){if(console.log(e),!t){var a=e.result.filter(function(t){return t.created_at>=P&&t.created_at<=B}),r=e.result.filter(function(t){return t.created_at>=O&&t.created_at<=S}),n=e.result.filter(function(t){return t.created_at>=R&&t.created_at<=E}),o=e.result.filter(function(t){return t.created_at>=C&&t.created_at<=F});if(n.length){var d=n.filter(function(t){if(t.financial_status)return"paid"===t.financial_status.current||"authorized"===t.financial_status.current});y.text(window.ecomUtils.formatMoney(d.reduce(Y).amount.total,"BRL"));var i=n.length,s=((L=d.length)/i*100).toFixed(2);x.text(s),M.text(i),T.text(L)}if(o.length){var u=o.filter(function(t){if(t.financial_status)return"paid"===t.financial_status.current||"authorized"===t.financial_status.current});A.text(window.ecomUtils.formatMoney(u.reduce(Y).amount.total,"BRL"));var l=o.length,c=((U=u.length)/l*100).toFixed(2);D.text(c),z.text(l),I.text(U)}if(r.length&&k.text(window.ecomUtils.formatMoney(r.reduce(Y).amount.total,"BRL")),a.length){h.find("#cards-graphs-orders").show();for(var f=0;f<a.length;f++)if(w.text(window.ecomUtils.formatMoney(a.reduce(Y).amount.total,"BRL")),a[f].financial_status){var m=[];switch(m.push(a[f]._id,a[f].number,a[f].financial_status.current,a[f].amount.total.toFixed(2).replace(".",","),a[f].buyers[0]._id,a[f].buyers[0].display_name),m[2]){case"under_analysis":m[2]="Em análise";break;case"authorized":m[2]="Autorizado";break;case"pending":m[2]="Pendente";break;case"refunded":m[2]="Devolvido";break;case"paid":m[2]="Aprovado";break;case"in_dispute":m[2]="Disputa";break;case"voided":m[2]="Cancelado";break;case"unauthorized":m[2]="Não autorizado";break;case"partially_paid":m[2]="Parcialmente Pago";break;case"partially_refunded":m[2]="Parcialmente devolvido";break;case"unknown":m[2]="Desconhecido"}v.append('<tr>  <th scope="row"><a href="/#/resources/orders/'+m[0]+' ">'+m[1]+" </a></th>  <td>"+m[2]+"</td>  <td> R$ "+m[3]+'</td>  <td><a href="/#/resources/customers/'+m[4]+' ">'+m[5]+" </a></td></tr>");var g=a[f].financial_status.current;"paid"!==g&&"authorized"!==g||(b+=1),"voided"===g&&(_+=1),"pending"===g&&(p+=1),Z(b,p,_)}else f+=1}}})},100)});var Z=function(){var t=document.getElementById("orderOfAll");new Chart(t,{type:"bar",data:{labels:["Aprovados","Pendentes","Cancelados"],datasets:[{label:"Pedidos",data:[b,p,_],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}};window.Tabs[G].$form?t():$(document).one("form-"+G,t)}();