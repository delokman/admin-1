!function(){"use strict";var f=window.tabId,t=function(){var b=$("#app-tab-"+f),h=0,p=0,_=0,w=b.find("#cards-graphs-amount").find("#dayAmount"),t=b.find("#home-cards"),n=t.find("#home-name"),o=t.find("#home-object"),e=t.find("#home-id"),a=localStorage.getItem("store_id"),v=b.find("#lastOrders").find("#addOrders"),S=b.find("#approved"),y=b.find("#monthAmount"),r=b.find("#cards-graphs-amount-last"),I=b.find("#lastApproved"),D=b.find("#lastMonthAmount"),A=r.find("#lastDayAmount"),i=new Date,d=i.getDate(),s=i.getMonth(),c=i.getFullYear(),u=(new Date).getTimezoneOffset(),k=new Date(c,s,d-1,0,-u,0,0).toISOString(),x=new Date(c,s,d-1,23,59-u,59,0).toISOString(),O=new Date(c,s-1,1,0,-u,0,0).toISOString(),z=new Date(c,s-1,31,23,59-u,59,0).toISOString(),C=new Date(c,s,d,0,-u,0,0).toISOString(),M=new Date(c,s,d,23,59-u,59,0).toISOString(),P=new Date(c,s,1,0,-u,0,0).toISOString(),B=new Date(c,s,31,23,59-u,59,0).toISOString(),l="orders.json?sort=amount&created_at>="+O+"&fields=buyers,amount,_id,created_at,financial_status,number,status";e.text(a);var R=function(t,e){return{amount:{total:t.amount.total+e.amount.total}}};window.callApi("stores/me.json","GET",function(t,e){if(!t){var a=e.name;n.text(a);var r=e._id;o.text(r),localStorage.setItem("fromAddress",e.address),localStorage.setItem("fromContact",e.contact_phone),localStorage.setItem("fromName",e.name),localStorage.setItem("fromCorporate",e.corporate_name),localStorage.setItem("domain",e.domain)}}),$(document).ready(function(){setTimeout(function(){window.callApi(l,"GET",function(t,e){if(!t){var a=e.result.filter(function(t){return t.created_at>=C&&t.created_at<=M}),r=e.result.filter(function(t){return t.created_at>=k&&t.created_at<=x}),n=e.result.filter(function(t){return t.created_at>=P&&t.created_at<=B}),o=e.result.filter(function(t){return t.created_at>=O&&t.created_at<=z});if(n.length){var i=n.filter(function(t){if(t.financial_status)return"paid"===t.financial_status.current||"authorized"===t.financial_status.current});y.text(window.ecomUtils.formatMoney(i.reduce(R).amount.total,"BRL"));var d=n.length,s=((i.length+1)/d*100).toFixed(2);S.text(s)}if(o.length){var c=o.filter(function(t){if(t.financial_status)return"paid"===t.financial_status.current||"authorized"===t.financial_status.current});D.text(window.ecomUtils.formatMoney(c.reduce(R).amount.total,"BRL"));var u=o.length,l=((c.length+1)/u*100).toFixed(2);I.text(l)}if(r.length&&A.text(window.ecomUtils.formatMoney(r.reduce(R).amount.total,"BRL")),a.length){b.find("#cards-graphs-orders").show();for(var f=0;f<a.length;f++)if(w.text(window.ecomUtils.formatMoney(a.reduce(R).amount.total,"BRL")),a[f].financial_status){var m=[];switch(m.push(a[f]._id,a[f].number,a[f].financial_status.current,a[f].amount.total.toFixed(2).replace(".",","),a[f].buyers[0]._id,a[f].buyers[0].display_name),m[2]){case"under_analysis":m[2]="Em análise";break;case"authorized":m[2]="Autorizado";break;case"pending":m[2]="Pendente";break;case"refunded":m[2]="Devolvido";break;case"paid":m[2]="Aprovado";break;case"in_dispute":m[2]="Disputa";break;case"voided":m[2]="Cancelado";break;case"unauthorized":m[2]="Não autorizado";break;case"partially_paid":m[2]="Parcialmente Pago";break;case"partially_refunded":m[2]="Parcialmente devolvido";break;case"unknown":m[2]="Desconhecido"}v.append('<tr>  <th scope="row"><a href="/#/resources/orders/'+m[0]+' ">'+m[1]+" </a></th>  <td>"+m[2]+"</td>  <td> R$ "+m[3]+'</td>  <td><a href="/#/resources/customers/'+m[4]+' ">'+m[5]+" </a></td></tr>");var g=a[f].financial_status.current;"paid"!==g&&"authorized"!==g||(p+=1),"voided"===g&&(_+=1),"pending"===g&&(h+=1),T(p,h,_)}else f+=1}}})},100)});var T=function(){var t=document.getElementById("orderOfAll");new Chart(t,{type:"bar",data:{labels:["Aprovados","Pendentes","Cancelados"],datasets:[{label:"Pedidos",data:[p,h,_],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}};window.Tabs[f].$form?t():$(document).one("form-"+f,t)}();