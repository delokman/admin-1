!function(){"use strict";var f=window.tabId,t=function(){var h=$("#app-tab-"+f),p=0,b=0,_=0,w=h.find("#cards-graphs-amount").find("#dayAmount"),t=h.find("#home-cards"),n=t.find("#home-name"),o=t.find("#home-object"),e=t.find("#home-id"),a=localStorage.getItem("store_id"),v=h.find("#lastOrders").find("#addOrders"),S=h.find("#approved"),x=h.find("#monthAmount"),r=h.find("#cards-graphs-amount-last"),y=h.find("#lastApproved"),A=h.find("#lastMonthAmount"),I=r.find("#lastDayAmount"),O=h.find("#monthTotalOrders"),D=h.find("#monthTotalOrdersApproved"),k=h.find("#lastMonthTotalOrders"),T=h.find("#lastMonthTotalOrdersApproved"),i=new Date,d=i.getDate(),s=i.getMonth(),l=i.getFullYear(),c=(new Date).getTimezoneOffset(),z=0,M=0,C=new Date(l,s,d-1,0,-c,0,0).toISOString(),P=new Date(l,s,d-1,23,59-c,59,0).toISOString(),B=new Date(l,s-1,1,0,-c,0,0).toISOString(),R=new Date(l,s-1,31,23,59-c,59,0).toISOString(),E=new Date(l,s,d,0,-c,0,0).toISOString(),F=new Date(l,s,d,23,59-c,59,0).toISOString(),L=new Date(l,s,1,0,-c,0,0).toISOString(),U=new Date(l,s,31,23,59-c,59,0).toISOString(),u="orders.json?sort=amount&created_at>="+B+"&fields=buyers,amount,_id,created_at,financial_status,number,status";e.text(a);var j=function(t,e){return{amount:{total:t.amount.total+e.amount.total}}};window.callApi("stores/me.json","GET",function(t,e){if(!t){var a=e.name;n.text(a);var r=e._id;o.text(r),localStorage.setItem("fromAddress",e.address),localStorage.setItem("fromContact",e.contact_phone),localStorage.setItem("fromName",e.name),localStorage.setItem("fromCorporate",e.corporate_name),localStorage.setItem("domain",e.domain)}}),$(document).ready(function(){setTimeout(function(){window.callApi(u,"GET",function(t,e){if(!t){var a=e.result.filter(function(t){return t.created_at>=E&&t.created_at<=F}),r=e.result.filter(function(t){return t.created_at>=C&&t.created_at<=P}),n=e.result.filter(function(t){return t.created_at>=L&&t.created_at<=U}),o=e.result.filter(function(t){return t.created_at>=B&&t.created_at<=R});if(n.length){var i=n.filter(function(t){if(t.financial_status)return"paid"===t.financial_status.current||"authorized"===t.financial_status.current});x.text(window.ecomUtils.formatMoney(i.reduce(j).amount.total,"BRL"));var d=n.length,s=((z=i.length)/d*100).toFixed(2);S.text(s),O.text(d),D.text(z)}if(o.length){var l=o.filter(function(t){if(t.financial_status)return"paid"===t.financial_status.current||"authorized"===t.financial_status.current});A.text(window.ecomUtils.formatMoney(l.reduce(j).amount.total,"BRL"));var c=o.length,u=((M=l.length)/c*100).toFixed(2);y.text(u),k.text(c),T.text(M)}if(r.length&&I.text(window.ecomUtils.formatMoney(r.reduce(j).amount.total,"BRL")),a.length){h.find("#cards-graphs-orders").show();for(var f=0;f<a.length;f++)if(w.text(window.ecomUtils.formatMoney(a.reduce(j).amount.total,"BRL")),a[f].financial_status){var m=[];switch(m.push(a[f]._id,a[f].number,a[f].financial_status.current,a[f].amount.total.toFixed(2).replace(".",","),a[f].buyers[0]._id,a[f].buyers[0].display_name),m[2]){case"under_analysis":m[2]="Em análise";break;case"authorized":m[2]="Autorizado";break;case"pending":m[2]="Pendente";break;case"refunded":m[2]="Devolvido";break;case"paid":m[2]="Aprovado";break;case"in_dispute":m[2]="Disputa";break;case"voided":m[2]="Cancelado";break;case"unauthorized":m[2]="Não autorizado";break;case"partially_paid":m[2]="Parcialmente Pago";break;case"partially_refunded":m[2]="Parcialmente devolvido";break;case"unknown":m[2]="Desconhecido"}v.append('<tr>  <th scope="row"><a href="/#/resources/orders/'+m[0]+' ">'+m[1]+" </a></th>  <td>"+m[2]+"</td>  <td> R$ "+m[3]+'</td>  <td><a href="/#/resources/customers/'+m[4]+' ">'+m[5]+" </a></td></tr>");var g=a[f].financial_status.current;"paid"!==g&&"authorized"!==g||(b+=1),"voided"===g&&(_+=1),"pending"===g&&(p+=1),G(b,p,_)}else f+=1}}})},100)});var G=function(){var t=document.getElementById("orderOfAll");new Chart(t,{type:"bar",data:{labels:["Aprovados","Pendentes","Cancelados"],datasets:[{label:"Pedidos",data:[b,p,_],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}};window.Tabs[f].$form?t():$(document).one("form-"+f,t)}();