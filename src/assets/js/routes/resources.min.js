!function(){"use strict";var s=window.tabId,r=window.Tabs[s];window.renderContentIds();var l=window.routeParams[0];if(void 0!==l){var e=window.apiResources[l];if(void 0!==e){var t,a,i,n,o,d=window.lang,c=window.i18n,u=window.routeParams[1];void 0===u?(t=c({en_us:"List",pt_br:"Listar"}),a=e.label[d],n=!0):("new"===u?(t=c({en_us:"Create",pt_br:"Criar"}),i=!(u=void 0)):t=c({en_us:"Edit",pt_br:"Editar"}),a=e.label[d]+" · "+t),window.maskDocNumber=function(e){return"j"===e.registry_type?e.doc_number.replace(/(\d{2})(\d{3})(\d{3})\/(\d{4})(\d{2})/,"$1.$2.$3.$4-$5"):e.doc_number.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4")},void 0===u?(o="<strong>"+e.label[d]+"</strong> · "+t,$("#t"+s+"-resource-name").html(o)):(o="<strong>"+e.label[d]+"</strong> · "+t+' <a class="btn btn-pure" style="font-size: 10px; background: rgba(223,242,0,0.1); padding: 3px 10px" data-provide="tooltip" id="clipboad" data-placement="top" data-original-title="Clique para copiar ID" data-clipboard-text="'+u+'">ID <i class="ti-clipboard"></i></a>',$("#t"+s+"-resource-name").html(o),$("#clipboad").hover(function(){$(this).tooltip("show")}),$("#clipboad").click(function(){$(this).attr("data-original-title","ID copiado!"),$(this).find(".ti-clipboard").replaceWith('<i class="ti-check"></i>'),$(this).tooltip("show")})),o='<li class="breadcrumb-item"><a href="/#/resources/'+l+'"><i class="fa fa-'+e.icon+'"></i> '+e.label[d]+'</a></li><li class="breadcrumb-item active">'+t+"</li>",$("#t"+s+"-breadcrumbs").append(o);var m=ace.edit("t"+s+"-code-editor");m.setTheme("ace/theme/dawn"),m.session.setMode("ace/mode/json"),$("#t"+s+"-code-tab").click(function(){setTimeout(function(){m.focus(),m.renderer.updateFull()},200)});var p=function(e){var t;e||(!0===n?t="products"!==l?"routes/resources/list.html":"routes/resources/list/products.html":(t="routes/resources/form/"+l+".html",r.commit=f,m.on("blur",function(){var e;try{e=JSON.parse(m.session.getValue())}catch(e){return}r.data=e}),m.on("change",function(){window.triggerUnsaved(s)})),window.loadContent(t,$("#t"+s+"-tab-normal")));window.routeReady(a)},f=function(e,t){t||(r.data=e),m.session.setValue(JSON.stringify(e,null,4))};if(r.resourceId=u,r.slug=l,!0!==i){var _,b,w;if(void 0===u)if(m.setReadOnly(!0),"products"===l){var g={sort:[{available:{order:"desc"}},"_score",{ad_relevance:{order:"desc"}},{_id:{order:"desc"}}],aggs:{"brands.name":{terms:{field:"brands.name"}},"categories.name":{terms:{field:"categories.name"}},status:{terms:{field:"status"}},min_price:{min:{field:"price"}},max_price:{max:{field:"price"}},avg_price:{avg:{field:"price"}}},size:30};b=function(a,e,t,i,s){var n;n=e?Object.assign({query:e},g):g,t&&(4<n.sort.length?n.sort[2]=t:n.sort.splice(2,0,t)),s&&(n.size=s),n.from=i?n.size*i:0,window.callSearchApi("items.json","POST",function(e,t){e||f(t),"function"==typeof a&&a(null,t)},n)}}else _=l+".json","orders"===l&&(w="limit=60&sort=-updated_at&fields=buyers,fulfillment_status,amount,_id,created_at,financial_status,number,status,code,source_name,items,payment_method_label,shipping_method_label,updated_at,extra_discount"),"customers"===l&&(w="limit=60&sort=-updated_at&fields=accepts_marketing,display_name,enabled,_id,created_at,login,main_email,orders_count,orders_total_value,state,updated_at,doc_number,registry_type"),"customers"!==l&&"orders"!==l&&(w="limit=60&sort=-updated_at");else if(_=l+"/"+u+".json",r.state.pagination){var v=$("#t"+s+"-pagination-next"),h=$("#t"+s+"-pagination-prev");0===r.state.page&&h.addClass("disabled"),r.pagination=r.state.pagination,h.click(function(){$(this).addClass("disabled"),r.pagination(!0)}),v.click(function(){$(this).addClass("disabled"),r.pagination()}).closest(".pagination-arrows").fadeIn()}b||(b=function(i,e){var t=_;e&&("orders"===l&&(-1<e.indexOf("fields")?t+="?"+e:t+="?"+e+"&fields=buyers,fulfillment_status,amount,_id,created_at,financial_status,number,status,code,source_name,items,payment_method_label,shipping_method_label,updated_at,extra_discount"),"customers"===l&&(-1<e.indexOf("fields")?t+="?"+e:t+="?"+e+"&fields=accepts_marketing,display_name,enabled,_id,created_at,login,main_email,orders_count,orders_total_value,state,updated_at,doc_number,registry_type"),"customers"!==l&&"orders"!==l&&(t+="?"+e)),window.callApi(t,"GET",function(e,t){if(!e){if(void 0!==u){if(t.created_at){var a=["day","month","year","hour","minute","second"];t.updated_at&&$("#t"+s+"-updated-at").text(formatDate(t.updated_at,a)),$("#t"+s+"-created-at").text(formatDate(t.created_at,a)).closest(".document-dates").fadeIn()}delete t._id,delete t.store_id,delete t.created_at,delete t.updated_at}f(t)}"function"==typeof i&&i(null,t)})}),r.load=b,$("#t"+s+"-new").fadeIn().click(function(){window.location="/"+window.location.hash+"/new"}),r.selectedItems=[],r.editItemsCallback=function(){return function(){}},r.editItems=function(e){y("PATCH",e)};var y=function(t,a){var i=r.selectedItems.length;if(0<i){$("#modal-saved").modal("show");var s=r.editItemsCallback(),n=0,o=[],d=function(){var e=r.selectedItems[n];window.callApi(l+"/"+e+".json",t,function(e){e&&o.push(e),++n===i?("function"==typeof s&&s(o),r.selectedItems=[]):d()},a)};$("#list-save-changes").click(d),$("#ignore-unsaved").click(function(){r.selectedItems=[],b(p,w)})}else u||app.toast(c({en_us:"No items selected",pt_br:"Nenhum item selecionado"}))};$("#t"+s+"-delete").fadeIn().click(function(){!function(t,a){var i=r.selectedItems.length;if(0<i){var s=r.editItemsCallback(),n=0,o=[],d=function(){var e=r.selectedItems[n];window.callApi(l+"/"+e+".json",t,function(e){e&&o.push(e),++n===i?("function"==typeof s&&s(o),r.selectedItems=[]):d()},a)};d()}else u||app.toast(c({en_us:"No items selected",pt_br:"Nenhum item selecionado"}))}("DELETE")}),b(p,w)}else f({}),p()}else window.e404()}else window.e404()}();