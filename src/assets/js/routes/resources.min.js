!function(){"use strict";var n=window.tabId,d=window.Tabs[n];window.renderContentIds();var c=window.routeParams[0];if(void 0!==c){var e=window.apiResources[c];if(void 0!==e){var t,a,i,s,o,r=window.lang,l=window.i18n,u=window.routeParams[1];void 0===u?(t=l({en_us:"List",pt_br:"Listar"}),a=e.label[r],s=!0):("new"===u?(t=l({en_us:"Create",pt_br:"Criar"}),i=!(u=void 0)):t=l({en_us:"Edit",pt_br:"Editar"}),a=e.label[r]+" · "+t),o="<strong>"+e.label[r]+"</strong> · "+t,$("#t"+n+"-resource-name").html(o),o='<li class="breadcrumb-item"><a href="/#/resources/'+c+'"><i class="fa fa-'+e.icon+'"></i> '+e.label[r]+'</a></li><li class="breadcrumb-item active">'+t+"</li>",$("#t"+n+"-breadcrumbs").append(o);var f=ace.edit("t"+n+"-code-editor");f.setTheme("ace/theme/dawn"),f.session.setMode("ace/mode/json"),$("#t"+n+"-code-tab").click(function(){setTimeout(function(){f.focus(),f.renderer.updateFull()},200)});var m=function(e){var t;e||(!0===s?t="products"!==c?"routes/resources/list.html":"routes/resources/list/products.html":(t="routes/resources/form/"+c+".html",d.commit=p,f.on("blur",function(){var e;try{e=JSON.parse(f.session.getValue())}catch(e){return}d.data=e}),f.on("change",function(){window.triggerUnsaved(n)})),window.loadContent(t,$("#t"+n+"-tab-normal")));window.routeReady(a)},p=function(e,t){t||(d.data=e),f.session.setValue(JSON.stringify(e,null,4))};if(d.resourceId=u,d.slug=c,!0!==i){var w,v,b;if(void 0===u)if(f.setReadOnly(!0),"products"===c){var g={sort:[{available:{order:"desc"}},"_score",{ad_relevance:{order:"desc"}},{_id:{order:"desc"}}],aggs:{"brands.name":{terms:{field:"brands.name"}},"categories.name":{terms:{field:"categories.name"}},status:{terms:{field:"status"}},min_price:{min:{field:"price"}},max_price:{max:{field:"price"}},avg_price:{avg:{field:"price"}}},size:30};v=function(a,e,t,i,n){var s;s=e?Object.assign({query:e},g):g,t&&(4<s.sort.length?s.sort[2]=t:s.sort.splice(2,0,t)),n&&(s.size=n),s.from=i?s.size*i:0,window.callSearchApi("items.json","POST",function(e,t){e||p(t),"function"==typeof a&&a(null,t)},s)}}else w=c+".json",b="limit=60&sort=-updated_at";else if(w=c+"/"+u+".json",d.state.pagination){var _=$("#t"+n+"-pagination-next"),h=$("#t"+n+"-pagination-prev");0===d.state.page&&h.addClass("disabled"),d.pagination=d.state.pagination,h.click(function(){$(this).addClass("disabled"),d.pagination(!0)}),_.click(function(){$(this).addClass("disabled"),d.pagination()}).closest(".pagination-arrows").fadeIn()}v||(v=function(i,e){var t=w;e&&(t+="?"+e),window.callApi(t,"GET",function(e,t){if(!e){if(void 0!==u){if(t.created_at){var a=["day","month","year","hour","minute","second"];t.updated_at&&$("#t"+n+"-updated-at").text(formatDate(t.updated_at,a)),$("#t"+n+"-created-at").text(formatDate(t.created_at,a)).closest(".document-dates").fadeIn()}delete t._id,delete t.store_id,delete t.created_at,delete t.updated_at}p(t)}"function"==typeof i&&i(null,t)})}),d.load=v,$("#t"+n+"-new").fadeIn().click(function(){window.location="/"+window.location.hash+"/new"}),d.selectedItems=[],d.editItemsCallback=function(){return function(){}},d.editItems=function(e){I("PATCH",e)};var I=function(t,a){var i=d.selectedItems.length;if(0<i){var n=d.editItemsCallback(),s=0,o=[],r=function(){var e=d.selectedItems[s];window.callApi(c+"/"+e+".json",t,function(e){e&&o.push(e),++s===i?("function"==typeof n&&n(o),d.selectedItems=[]):r()},a)};r()}else u||app.toast(l({en_us:"No items selected",pt_br:"Nenhum item selecionado"}))};$("#t"+n+"-delete").fadeIn().click(function(){I("DELETE")}),v(m,b)}else p({}),m()}else window.e404()}else window.e404()}();